
# Functional Testing definition model for Shaddock.
# =================================================

# """ Scheduling definiton:
# - {name: nova, status: stopped}
# - {name: nova, port: 8774, type: tcp}
# - {name: nova, port: 8774, state: down, type: tcp}
# - {host: google.com, port: 8774, state: down, type: tcp}
# - {name: nova, type: http, get: '/v2.0', port: 5000, code: 200}
# - {host: google.com, type: http, get: '/v2.0', port: 5000, code: 200}
# - {host: 127.0.0.1, type: http, get: '/', code: 200, useproxy: False }
# - {name: nova, sleep: 20} # defaults to 10
# - {name: nova, retry: 10} # defaults to 5
# """

---

clusters: 

  - name: sched-cluster0
    images: images/testdir
    vars: 
      toto: plop
    services:
      - name: test001
        image: testuser/arch_base:latest
        priority: 500
      
      - name: test002
        image: testuser/arch_base:latest
        priority: 510

      - name: test003
        image: testuser/arch_base:latest
        priority: 520
        depends-on:
          - {name: test001, status: stopped}
          - {name: test002, status: stopped, retry: 40}

      - name: test004
        image: testuser/arch_base:latest
        priority: 530

      - name: test005
        image: testuser/arch_base:latest
        priority: 540
        depends-on:
          - {name: test004, status: stopped, sleep: 5}

  - name: sched-cluster1
    images: images/testdir
    services:     
      - name: test006
        image: testuser/netcat:latest
        priority: 550
        ports:
            1234: None
        command: "nc -l 1234"

      - name: test007
        image: testuser/arch_base:latest
        priority: 560
        depends-on:
          - {name: test002, status: stopped, retry: 40}
          - {name: test006, port: 1234, type: tcp}
